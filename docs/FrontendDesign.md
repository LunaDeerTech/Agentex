# Agentex 前端界面设计

## 文档信息

| 项目 | 内容 |
|------|------|
| 产品名称 | Agentex |
| 版本 | 1.0.0 |
| 文档版本 | 1.0 |
| 更新日期 | 2026-02-03 |

---

## 1. 设计规范

### 1.1 设计原则

| 原则 | 说明 |
|------|------|
| 简洁性 | 界面简洁明了，减少认知负担 |
| 一致性 | 统一的交互模式和视觉风格 |
| 响应性 | 快速反馈用户操作 |
| 可访问性 | 支持键盘操作和屏幕阅读器 |

### 1.2 色彩规范

| 类型 | 色值 | 用途 |
|------|------|------|
| 主色调 | #409EFF | 主要按钮、链接、强调 |
| 成功色 | #67C23A | 成功状态、确认操作 |
| 警告色 | #E6A23C | 警告提示 |
| 危险色 | #F56C6C | 错误、删除操作 |
| 信息色 | #909399 | 辅助信息 |
| 背景色 | #F5F7FA | 页面背景 |
| 边框色 | #DCDFE6 | 边框、分隔线 |
| 文字主色 | #303133 | 主要文字 |
| 文字次色 | #606266 | 次要文字 |
| 文字占位 | #C0C4CC | 占位文字 |

### 1.3 字体规范

| 类型 | 字体 | 大小 |
|------|------|------|
| 标题 H1 | PingFang SC, Microsoft YaHei | 24px |
| 标题 H2 | PingFang SC, Microsoft YaHei | 20px |
| 标题 H3 | PingFang SC, Microsoft YaHei | 18px |
| 正文 | PingFang SC, Microsoft YaHei | 14px |
| 辅助文字 | PingFang SC, Microsoft YaHei | 12px |
| 代码 | Consolas, Monaco, monospace | 13px |

### 1.4 间距规范

| 类型 | 值 |
|------|-----|
| 页面边距 | 24px |
| 模块间距 | 20px |
| 元素间距 | 16px |
| 紧凑间距 | 8px |
| 最小间距 | 4px |

---

## 2. 页面结构

### 2.1 整体布局

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                   App                                        │
│                                                                              │
│  ┌───────────────────────────────────────────────────────────────────────┐  │
│  │                              Router View                               │  │
│  │                                                                        │  │
│  │   ┌────────────────────────────────────────────────────────────────┐  │  │
│  │   │                         Layout                                  │  │  │
│  │   │                                                                 │  │  │
│  │   │   根据路由显示不同的布局：                                        │  │  │
│  │   │   - MainLayout (对话页)                                         │  │  │
│  │   │   - SettingsLayout (设置页)                                     │  │  │
│  │   │   - AuthLayout (登录/注册页)                                    │  │  │
│  │   │                                                                 │  │  │
│  │   └────────────────────────────────────────────────────────────────┘  │  │
│  │                                                                        │  │
│  └───────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 2.2 路由结构

```
/                           → 主对话页 (ChatView)
/login                      → 登录页 (LoginView)
/register                   → 注册页 (RegisterView)
/settings                   → 设置页 (SettingsView)
  /settings/profile         → 个人信息
  /settings/models          → 模型管理
  /settings/mcp             → MCP 连接
  /settings/knowledge       → 知识库管理
  /settings/skills          → SKILL 管理
  /settings/rules           → 规则引擎
  /settings/users           → 用户管理 (admin)
  /settings/system          → 系统设置 (admin)
```

---

## 3. 主对话页设计

### 3.1 页面布局

```
┌─────────────────────────────────────────────────────────────────────────────┐
│ Logo ─ Agentex                                              [用户头像] [设置] │
├──────────────┬──────────────────────────────────────────────────────────────┤
│              │                                                               │
│  会话列表     │                        对话区域                               │
│              │                                                               │
│  ┌────────┐  │  ┌─────────────────────────────────────────────────────────┐ │
│  │ + 新会话│  │  │                                                         │ │
│  └────────┘  │  │                       消息列表                           │ │
│              │  │                                                         │ │
│  ┌────────┐  │  │  ┌─────────────────────────────────────────────────┐   │ │
│  │ 会话 1  │  │  │  │ 👤 用户消息                                     │   │ │
│  │ 2小时前 │  │  │  └─────────────────────────────────────────────────┘   │ │
│  ├────────┤  │  │                                                         │ │
│  │ 会话 2  │  │  │  ┌─────────────────────────────────────────────────┐   │ │
│  │ 昨天    │  │  │  │ 🤔 思考过程 (可折叠)                            │   │ │
│  ├────────┤  │  │  │ ├─ 分析用户意图                                  │   │ │
│  │ 会话 3  │  │  │  │ ├─ 需要调用工具                                  │   │ │
│  │ 3天前   │  │  │  │ └─ 选择: server_status                          │   │ │
│  └────────┘  │  │  └─────────────────────────────────────────────────┘   │ │
│              │  │                                                         │ │
│              │  │  ┌─────────────────────────────────────────────────┐   │ │
│              │  │  │ 🔧 工具调用 (可折叠)                             │   │ │
│              │  │  │ Tool: server_status                              │   │ │
│              │  │  │ Input: {}                                        │   │ │
│              │  │  │ Output: { "status": "online", "players": 10 }    │   │ │
│              │  │  └─────────────────────────────────────────────────┘   │ │
│              │  │                                                         │ │
│              │  │  ┌─────────────────────────────────────────────────┐   │ │
│              │  │  │ 🤖 Agent 回复                                    │   │ │
│              │  │  │ 服务器当前状态正常，在线玩家 10 人。              │   │ │
│              │  │  └─────────────────────────────────────────────────┘   │ │
│              │  │                                                         │ │
│              │  └─────────────────────────────────────────────────────────┘ │
│              │                                                               │
│              ├───────────────────────────────────────────────────────────────┤
│              │                                                               │
│              │  ┌─────────────────────────────────────────────────────────┐ │
│  ┌────────┐  │  │ [Agent▼] [知识库▼] [工具▼] [SKILL▼]                      │ │
│  │ 👤 用户 │  │  │                                                         │ │
│  │ ⚙️ 设置 │  │  │  ┌───────────────────────────────────────────────────┐ │ │
│  └────────┘  │  │  │ 请输入您的问题...                                  │ │ │
│              │  │  └───────────────────────────────────────────────────┘ │ │
│              │  │                                                         │ │
│              │  │                               [模型选择▼] [📎] [发送▶] │ │
│              │  └─────────────────────────────────────────────────────────┘ │
│              │                                                               │
└──────────────┴───────────────────────────────────────────────────────────────┘
```

### 3.2 组件拆分

#### 3.2.1 侧边栏 (ChatSidebar)

```
ChatSidebar
├── 新建会话按钮
├── 会话列表
│   └── SessionItem
│       ├── 会话标题
│       ├── 时间显示
│       ├── 右键菜单 (重命名、删除)
│       └── 选中状态
└── 用户信息区
    ├── 用户头像
    ├── 用户名
    └── 设置入口
```

**交互说明：**
- 点击「新建会话」创建新的对话会话
- 点击会话项切换到对应会话
- 右键会话项显示菜单（重命名、删除）
- 拖拽可调整会话顺序（可选功能）
- 点击用户区域进入设置页面

#### 3.2.2 消息列表 (MessageList)

```
MessageList
├── 空状态提示 (无消息时显示)
└── 消息项列表
    └── MessageItem
        ├── UserMessage      # 用户消息
        ├── AssistantMessage # Agent 回复
        ├── ThinkingBlock    # 思考过程
        ├── ToolCallBlock    # 工具调用
        ├── RetrievalBlock   # 知识检索
        └── ErrorMessage     # 错误消息
```

**消息类型组件：**

| 组件 | 说明 | 样式 |
|------|------|------|
| UserMessage | 用户发送的消息 | 右对齐，蓝色背景 |
| AssistantMessage | Agent 的回复 | 左对齐，白色背景 |
| ThinkingBlock | 思考过程展示 | 可折叠，灰色边框 |
| ToolCallBlock | 工具调用详情 | 可折叠，代码块样式 |
| RetrievalBlock | 知识检索结果 | 可折叠，引用样式 |
| ErrorMessage | 错误信息 | 红色边框 |

#### 3.2.3 输入区域 (ChatInput)

```
ChatInput
├── 配置栏
│   ├── AgentSelector      # Agent 架构选择
│   ├── KnowledgeSelector  # 知识库选择（多选）
│   ├── ToolSelector       # MCP 工具选择（多选）
│   └── SkillSelector      # SKILL 选择（多选）
├── 输入框
│   ├── 多行文本输入
│   ├── 快捷键支持 (Ctrl+Enter 发送)
│   └── 自动高度调整
└── 操作栏
    ├── ModelSelector      # 模型选择
    ├── AttachButton       # 附件按钮（可选）
    └── SendButton         # 发送按钮
```

**交互说明：**
- Agent 架构选择：下拉选择，显示架构名称和简要说明
- 知识库选择：多选下拉，显示已选数量
- 工具选择：多选下拉，按 MCP 连接分组
- SKILL 选择：多选下拉，显示 SKILL 名称
- 模型选择：下拉选择，显示模型名称
- 发送按钮：发送消息，发送中显示停止按钮

### 3.3 消息展示详细设计

#### 3.3.1 思考过程块 (ThinkingBlock)

```
┌──────────────────────────────────────────────────────────────────────────┐
│ 🤔 思考过程                                                    [▼ 折叠] │
├──────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│  > 分析用户意图                                                          │
│    用户想要查询服务器的状态信息                                           │
│                                                                          │
│  > 选择工具                                                              │
│    需要调用 server_status 工具来获取服务器状态                            │
│                                                                          │
│  > 准备参数                                                              │
│    该工具无需额外参数                                                     │
│                                                                          │
└──────────────────────────────────────────────────────────────────────────┘
```

#### 3.3.2 工具调用块 (ToolCallBlock)

```
┌──────────────────────────────────────────────────────────────────────────┐
│ 🔧 调用工具: server_status                                    [▼ 折叠] │
├──────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│  输入参数:                                                               │
│  ┌────────────────────────────────────────────────────────────────────┐ │
│  │ {}                                                                  │ │
│  └────────────────────────────────────────────────────────────────────┘ │
│                                                                          │
│  执行结果:                                                               │
│  ┌────────────────────────────────────────────────────────────────────┐ │
│  │ {                                                                   │ │
│  │   "status": "online",                                               │ │
│  │   "players": 10,                                                    │ │
│  │   "uptime": "3 days"                                                │ │
│  │ }                                                                   │ │
│  └────────────────────────────────────────────────────────────────────┘ │
│                                                                          │
│  耗时: 120ms                                                   [✓ 成功] │
│                                                                          │
└──────────────────────────────────────────────────────────────────────────┘
```

#### 3.3.3 知识检索块 (RetrievalBlock)

```
┌──────────────────────────────────────────────────────────────────────────┐
│ 📚 知识检索                                                    [▼ 折叠] │
├──────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│  检索查询: "服务器配置要求"                                              │
│                                                                          │
│  检索结果 (3 条):                                                        │
│                                                                          │
│  ┌────────────────────────────────────────────────────────────────────┐ │
│  │ 📄 部署文档.md                                        相似度: 0.92 │ │
│  │                                                                     │ │
│  │ 服务器最低配置要求：                                                 │ │
│  │ - CPU: 4 核                                                         │ │
│  │ - 内存: 8GB                                                         │ │
│  │ - 磁盘: 100GB SSD                                                   │ │
│  └────────────────────────────────────────────────────────────────────┘ │
│                                                                          │
│  ┌────────────────────────────────────────────────────────────────────┐ │
│  │ 📄 运维手册.md                                        相似度: 0.85 │ │
│  │ ...                                                                 │ │
│  └────────────────────────────────────────────────────────────────────┘ │
│                                                                          │
└──────────────────────────────────────────────────────────────────────────┘
```

---

## 4. 设置页面设计

### 4.1 页面布局

```
┌─────────────────────────────────────────────────────────────────────────────┐
│ [← 返回]                          设置                                      │
├──────────────────────┬──────────────────────────────────────────────────────┤
│                      │                                                       │
│  ┌────────────────┐  │                    内容区域                           │
│  │ 👤 个人信息     │  │                                                       │
│  └────────────────┘  │    根据左侧选择的菜单项显示对应的内容                   │
│                      │                                                       │
│  ── 资源管理 ──      │                                                       │
│  ┌────────────────┐  │                                                       │
│  │ 🤖 模型管理    │  │                                                       │
│  ├────────────────┤  │                                                       │
│  │ 🔌 MCP 连接    │  │                                                       │
│  ├────────────────┤  │                                                       │
│  │ 📚 知识库      │  │                                                       │
│  ├────────────────┤  │                                                       │
│  │ 🎯 SKILL 管理  │  │                                                       │
│  ├────────────────┤  │                                                       │
│  │ ⚡ 规则引擎    │  │                                                       │
│  └────────────────┘  │                                                       │
│                      │                                                       │
│  ── 系统管理 ──      │                                                       │
│  ┌────────────────┐  │                                                       │
│  │ 👥 用户管理    │  │                                                       │
│  ├────────────────┤  │                                                       │
│  │ ⚙️ 系统设置   │  │                                                       │
│  └────────────────┘  │                                                       │
│                      │                                                       │
└──────────────────────┴───────────────────────────────────────────────────────┘
```

### 4.2 个人信息页 (ProfileView)

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              个人信息                                        │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌──────────────────────────────────────────────────────────────────────┐  │
│  │ 基本信息                                                              │  │
│  ├──────────────────────────────────────────────────────────────────────┤  │
│  │                                                                       │  │
│  │      ┌─────────┐                                                     │  │
│  │      │         │    用户名: zhangsan                                  │  │
│  │      │  头像   │    邮  箱: zhangsan@example.com                      │  │
│  │      │         │    角  色: Developer                                 │  │
│  │      └─────────┘    注册时间: 2025-01-15                              │  │
│  │      [更换头像]                                                       │  │
│  │                                                                       │  │
│  │  [编辑信息]                                                           │  │
│  │                                                                       │  │
│  └──────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
│  ┌──────────────────────────────────────────────────────────────────────┐  │
│  │ 安全设置                                                              │  │
│  ├──────────────────────────────────────────────────────────────────────┤  │
│  │                                                                       │  │
│  │  密码     ••••••••••••                               [修改密码]      │  │
│  │                                                                       │  │
│  └──────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
│  ┌──────────────────────────────────────────────────────────────────────┐  │
│  │ API 密钥                                                    [+ 新建] │  │
│  ├──────────────────────────────────────────────────────────────────────┤  │
│  │                                                                       │  │
│  │  名称              密钥                   创建时间        操作        │  │
│  │  ─────────────────────────────────────────────────────────────────   │  │
│  │  开发测试          sk-...abc              2025-01-20      [撤销]     │  │
│  │  生产环境          sk-...xyz              2025-02-01      [撤销]     │  │
│  │                                                                       │  │
│  └──────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 4.3 模型管理页 (ModelsView)

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              模型管理                          [+ 添加模型] │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌──────────────────────────────────────────────────────────────────────┐  │
│  │                                                                       │  │
│  │  名称            提供商       模型ID           状态      操作         │  │
│  │  ─────────────────────────────────────────────────────────────────   │  │
│  │  GPT-4o          OpenAI      gpt-4o           ✅ 可用    [编辑][删除]│  │
│  │  Claude 3.5      Anthropic   claude-3.5...    ✅ 可用    [编辑][删除]│  │
│  │  DeepSeek        OpenAI*     deepseek-chat    ❌ 不可用  [编辑][删除]│  │
│  │  本地 Llama      OpenAI*     llama-3.1        ✅ 可用    [编辑][删除]│  │
│  │                                                                       │  │
│  │  * 表示使用 OpenAI 兼容协议                                           │  │
│  │                                                                       │  │
│  └──────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘

【添加/编辑模型弹窗】
┌─────────────────────────────────────────────────────────────────────────────┐
│                           添加模型                                    [×]   │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  模型名称:    [                                                        ]   │
│                                                                              │
│  提供商:      [OpenAI          ▼]                                          │
│                                                                              │
│  API 地址:    [https://api.openai.com/v1                               ]   │
│                                                                              │
│  API 密钥:    [                                                        ]   │
│                                                                              │
│  模型 ID:     [gpt-4o                                                  ]   │
│                                                                              │
│  最大 Token:  [4096                                                    ]   │
│                                                                              │
│  温度:        [0.7                                                     ]   │
│                                                                              │
│  □ 设为默认模型                                                             │
│                                                                              │
│  ☑ 启用                                                                     │
│                                                                              │
│                                              [测试连接]  [取消]  [保存]    │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 4.4 MCP 连接页 (MCPView)

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              MCP 连接管理                       [+ 添加连接]│
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ── 标准 MCP 连接 ──                                                        │
│  ┌──────────────────────────────────────────────────────────────────────┐  │
│  │                                                                       │  │
│  │  名称              地址                    状态       工具数   操作   │  │
│  │  ─────────────────────────────────────────────────────────────────   │  │
│  │  File System       http://localhost:3001   🟢 已连接   5个    [管理] │  │
│  │  GitHub            http://localhost:3002   🔴 断开     -      [管理] │  │
│  │                                                                       │  │
│  └──────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
│  ── WebSocket MCP 连接 ──                                                   │
│  ┌──────────────────────────────────────────────────────────────────────┐  │
│  │                                                                       │  │
│  │  名称              地址                    状态       工具数   操作   │  │
│  │  ─────────────────────────────────────────────────────────────────   │  │
│  │  Minecraft MCP     ws://localhost:8765     🟢 已连接   12个   [管理] │  │
│  │                                                                       │  │
│  └──────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘

【MCP 连接详情/管理弹窗】
┌─────────────────────────────────────────────────────────────────────────────┐
│                         Minecraft MCP                                  [×]  │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  [基本信息]  [工具列表]  [事件日志]                                          │
│                                                                              │
│  ── 工具列表 (12 个) ──                                                     │
│                                                                              │
│  ┌──────────────────────────────────────────────────────────────────────┐  │
│  │ 🔧 block_set                                                          │  │
│  │ 在指定位置放置方块                                                     │  │
│  │ 参数: location, material, blockData                                   │  │
│  ├──────────────────────────────────────────────────────────────────────┤  │
│  │ 🔧 block_get                                                          │  │
│  │ 获取指定位置的方块信息                                                 │  │
│  │ 参数: location                                                        │  │
│  ├──────────────────────────────────────────────────────────────────────┤  │
│  │ 🔧 chat_broadcast                                                     │  │
│  │ 向所有玩家广播消息                                                     │  │
│  │ 参数: message, color                                                  │  │
│  ├──────────────────────────────────────────────────────────────────────┤  │
│  │ ...                                                                   │  │
│  └──────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
│                                                   [断开连接]  [编辑]  [关闭]│
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 4.5 知识库管理页 (KnowledgeView)

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              知识库管理                        [+ 创建知识库]│
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌──────────────────────────────────────────────────────────────────────┐  │
│  │                                                                       │  │
│  │  ┌─────────────────────────────────┐  ┌─────────────────────────────┐│  │
│  │  │ 📚 产品文档知识库               │  │ 📚 技术文档知识库            ││  │
│  │  │                                 │  │                              ││  │
│  │  │ 文档数: 15                      │  │ 文档数: 28                   ││  │
│  │  │ 向量模型: text-embedding-3-small│  │ 向量模型: bge-large-zh       ││  │
│  │  │ 状态: ✅ 可用                   │  │ 状态: ✅ 可用                 ││  │
│  │  │                                 │  │                              ││  │
│  │  │              [管理] [删除]      │  │              [管理] [删除]   ││  │
│  │  └─────────────────────────────────┘  └─────────────────────────────┘│  │
│  │                                                                       │  │
│  │  ┌─────────────────────────────────┐                                 │  │
│  │  │ 📚 用户手册                     │                                 │  │
│  │  │                                 │                                 │  │
│  │  │ 文档数: 8                       │                                 │  │
│  │  │ 向量模型: text-embedding-3-small│                                 │  │
│  │  │ 状态: ⏳ 处理中 (3/8)           │                                 │  │
│  │  │                                 │                                 │  │
│  │  │              [管理] [删除]      │                                 │  │
│  │  └─────────────────────────────────┘                                 │  │
│  │                                                                       │  │
│  └──────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘

【知识库详情/管理页】
┌─────────────────────────────────────────────────────────────────────────────┐
│ [← 返回]                     产品文档知识库                                  │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  [基本设置]  [文档列表]  [检索测试]                                          │
│                                                                              │
│  ── 文档列表 ──                                                  [+ 上传]  │
│                                                                              │
│  ┌──────────────────────────────────────────────────────────────────────┐  │
│  │                                                                       │  │
│  │  文件名              类型      大小      状态        上传时间   操作  │  │
│  │  ─────────────────────────────────────────────────────────────────   │  │
│  │  产品介绍.md         Markdown  12KB      ✅ 完成     01-15     [删除]│  │
│  │  功能说明.pdf        PDF       256KB     ✅ 完成     01-16     [删除]│  │
│  │  API文档.md          Markdown  45KB      ⏳ 处理中   01-20     [删除]│  │
│  │  更新日志.txt        Text      8KB       ❌ 失败     01-20     [删除]│  │
│  │                                                                       │  │
│  └──────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 4.6 SKILL 管理页 (SkillsView)

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              SKILL 管理                        [+ 创建 SKILL]│
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  [我的 SKILL]  [公共 SKILL]                                                 │
│                                                                              │
│  ── 我的 SKILL ──                                                           │
│  ┌──────────────────────────────────────────────────────────────────────┐  │
│  │                                                                       │  │
│  │  ┌─────────────────────────────────────────────────────────────────┐ │  │
│  │  │ 🎯 代码审查                                               v1.2 │ │  │
│  │  │                                                                  │ │  │
│  │  │ 对提交的代码进行审查，检查代码质量、安全性和最佳实践。            │ │  │
│  │  │                                                                  │ │  │
│  │  │ 标签: [代码] [审查] [质量]                                       │ │  │
│  │  │ 创建: 2025-01-15  更新: 2025-02-01                              │ │  │
│  │  │                                                                  │ │  │
│  │  │                                    [预览] [编辑] [导出] [删除]  │ │  │
│  │  └─────────────────────────────────────────────────────────────────┘ │  │
│  │                                                                       │  │
│  │  ┌─────────────────────────────────────────────────────────────────┐ │  │
│  │  │ 🎯 日报生成                                               v1.0 │ │  │
│  │  │                                                                  │ │  │
│  │  │ 根据今日工作内容生成工作日报。                                    │ │  │
│  │  │                                                                  │ │  │
│  │  │ ...                                                              │ │  │
│  │  └─────────────────────────────────────────────────────────────────┘ │  │
│  │                                                                       │  │
│  └──────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘

【SKILL 编辑器】
┌─────────────────────────────────────────────────────────────────────────────┐
│                              编辑 SKILL                               [×]   │
├──────────────────────────────────────┬──────────────────────────────────────┤
│                                      │                                      │
│  Markdown 编辑器                      │  预览                                │
│                                      │                                      │
│  ┌────────────────────────────────┐  │  ┌────────────────────────────────┐ │
│  │ # SKILL: 代码审查              │  │  │ # SKILL: 代码审查              │ │
│  │                                │  │  │                                │ │
│  │ ## 描述                        │  │  │ ## 描述                        │ │
│  │ 对提交的代码进行审查...        │  │  │ 对提交的代码进行审查...        │ │
│  │                                │  │  │                                │ │
│  │ ## 触发条件                    │  │  │ ## 触发条件                    │ │
│  │ - 用户提交代码审查请求         │  │  │ - 用户提交代码审查请求         │ │
│  │ - 用户上传代码文件             │  │  │ - 用户上传代码文件             │ │
│  │                                │  │  │                                │ │
│  │ ## 输入参数                    │  │  │ ## 输入参数                    │ │
│  │ | 参数名 | 类型 | 必填 | 说明 |│  │  │ | 参数名 | 类型 | 必填 | 说明 |│ │
│  │ |--------|------|------|------|│  │  │ |--------|------|------|------|│ │
│  │ | code   | str  | 是   | 代码 |│  │  │ | code   | str  | 是   | 代码 |│ │
│  │                                │  │  │                                │ │
│  │ ## 执行步骤                    │  │  │ ## 执行步骤                    │ │
│  │ 1. 分析代码结构                │  │  │ 1. 分析代码结构                │ │
│  │ 2. 检查代码规范                │  │  │ 2. 检查代码规范                │ │
│  │ 3. 识别潜在问题                │  │  │ 3. 识别潜在问题                │ │
│  │ 4. 给出改进建议                │  │  │ 4. 给出改进建议                │ │
│  │                                │  │  │                                │ │
│  └────────────────────────────────┘  │  └────────────────────────────────┘ │
│                                      │                                      │
├──────────────────────────────────────┴──────────────────────────────────────┤
│                                                                              │
│  分类: [开发工具    ▼]   标签: [代码, 审查, 质量                         ] │
│                                                                              │
│  ☑ 公开此 SKILL                                                             │
│                                                                              │
│                                              [验证]  [取消]  [保存]         │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 4.7 规则引擎页 (RulesView)

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              规则引擎                            [+ 创建规则]│
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌──────────────────────────────────────────────────────────────────────┐  │
│  │                                                                       │  │
│  │  规则名称           事件类型        状态      最后触发      操作      │  │
│  │  ─────────────────────────────────────────────────────────────────   │  │
│  │  玩家进入欢迎       player_join     🟢 启用   10分钟前      [编辑]   │  │
│  │  低血量警告         player_damage   🟢 启用   2小时前       [编辑]   │  │
│  │  建筑区域保护       block_break     🔴 禁用   -             [编辑]   │  │
│  │                                                                       │  │
│  └──────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘

【规则编辑器】
┌─────────────────────────────────────────────────────────────────────────────┐
│                              编辑规则                                  [×]  │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  规则名称: [玩家进入欢迎                                               ]   │
│                                                                              │
│  描述:     [当玩家进入游戏时发送欢迎消息                               ]   │
│                                                                              │
│  ── 触发条件 ──                                                             │
│                                                                              │
│  事件来源: [Minecraft MCP         ▼]                                       │
│  事件类型: [player_join           ▼]                                       │
│                                                                              │
│  ── 筛选条件 ──                                                             │
│                                                                              │
│  ┌──────────────────────────────────────────────────────────────────────┐  │
│  │ [AND ▼]                                                               │  │
│  │                                                                       │  │
│  │   字段: [player.name   ] 运算: [!=        ▼] 值: [admin           ]  │  │
│  │   [+ 添加条件]                                                        │  │
│  │                                                                       │  │
│  └──────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
│  ── 执行动作 ──                                                             │
│                                                                              │
│  ┌──────────────────────────────────────────────────────────────────────┐  │
│  │ 动作 1:                                                               │  │
│  │ 类型: [调用 MCP 工具  ▼]                                              │  │
│  │ 工具: [chat_broadcast ▼]                                              │  │
│  │ 参数:                                                                 │  │
│  │   message: [欢迎 {{player.name}} 进入游戏！                      ]   │  │
│  │   color:   [green                                                ]   │  │
│  │                                                                       │  │
│  │ [+ 添加动作]                                                          │  │
│  └──────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
│  冷却时间: [5000                ] 毫秒                                      │
│                                                                              │
│  ☑ 启用规则                                                                 │
│                                                                              │
│                                              [测试]  [取消]  [保存]         │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 4.8 用户管理页 (UsersView) - 管理员

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              用户管理                            [+ 添加用户]│
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  搜索: [                                            ] [🔍]                  │
│                                                                              │
│  ┌──────────────────────────────────────────────────────────────────────┐  │
│  │                                                                       │  │
│  │  用户名       邮箱                   角色        状态      操作       │  │
│  │  ─────────────────────────────────────────────────────────────────   │  │
│  │  admin        admin@example.com      Admin       🟢 正常   [编辑]    │  │
│  │  zhangsan     zhang@example.com      Developer   🟢 正常   [编辑]    │  │
│  │  lisi         li@example.com         User        🟢 正常   [编辑]    │  │
│  │  wangwu       wang@example.com       User        🔴 禁用   [编辑]    │  │
│  │                                                                       │  │
│  │                                          第 1/2 页  [<] [1] [2] [>]  │  │
│  │                                                                       │  │
│  └──────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘

【用户编辑弹窗】
┌─────────────────────────────────────────────────────────────────────────────┐
│                              编辑用户                                  [×]  │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  用户名:    [zhangsan                                                  ]   │
│                                                                              │
│  邮箱:      [zhang@example.com                                         ]   │
│                                                                              │
│  角色:      [Developer       ▼]                                            │
│                                                                              │
│  ── 权限设置 ──                                                             │
│                                                                              │
│  ┌──────────────────────────────────────────────────────────────────────┐  │
│  │ 模块          查看    创建    编辑    删除                            │  │
│  │ ─────────────────────────────────────────────────────────────────    │  │
│  │ 模型管理      ☑       □       □       □                              │  │
│  │ MCP 连接      ☑       ☑       ☑       □                              │  │
│  │ 知识库        ☑       ☑       ☑       ☑                              │  │
│  │ SKILL         ☑       ☑       ☑       ☑                              │  │
│  │ 规则引擎      ☑       ☑       ☑       ☑                              │  │
│  │ 用户管理      □       □       □       □                              │  │
│  │ 系统设置      □       □       □       □                              │  │
│  │                                                                       │  │
│  └──────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
│  ── 可用资源 ──                                                             │
│                                                                              │
│  可用模型: ☑ GPT-4o  ☑ Claude 3.5  □ DeepSeek                              │
│  可用 MCP: ☑ Minecraft MCP  ☑ File System                                  │
│                                                                              │
│  ☑ 账户启用                                                                 │
│                                                                              │
│                                                         [取消]  [保存]      │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 5. 组件设计

### 5.1 公共组件

| 组件名 | 功能 | 使用场景 |
|--------|------|---------|
| AppHeader | 顶部导航栏 | 所有页面 |
| AppSidebar | 侧边栏容器 | 主页、设置页 |
| UserAvatar | 用户头像 | 用户信息展示 |
| LoadingSpinner | 加载动画 | 异步加载 |
| EmptyState | 空状态提示 | 列表为空时 |
| ConfirmDialog | 确认对话框 | 删除等危险操作 |
| JsonViewer | JSON 展示 | 工具调用结果展示 |
| MarkdownRenderer | Markdown 渲染 | Agent 回复、SKILL 预览 |
| CodeBlock | 代码块 | 代码展示 |
| Pagination | 分页组件 | 列表分页 |

### 5.2 业务组件

| 组件名 | 功能 | 使用场景 |
|--------|------|---------|
| SessionList | 会话列表 | 主页侧边栏 |
| SessionItem | 会话项 | 会话列表 |
| MessageList | 消息列表 | 对话区域 |
| MessageItem | 消息项 | 消息列表 |
| ThinkingBlock | 思考过程块 | Agent 思考展示 |
| ToolCallBlock | 工具调用块 | 工具调用展示 |
| ChatInput | 对话输入框 | 用户输入 |
| AgentSelector | Agent 选择器 | 输入区域 |
| ModelSelector | 模型选择器 | 输入区域 |
| ToolSelector | 工具选择器 | 输入区域 |
| KnowledgeSelector | 知识库选择器 | 输入区域 |
| SkillSelector | SKILL 选择器 | 输入区域 |
| RuleEditor | 规则编辑器 | 规则配置 |
| ConditionBuilder | 条件构建器 | 规则条件配置 |
| ActionConfig | 动作配置器 | 规则动作配置 |
| SkillEditor | SKILL 编辑器 | SKILL 编写 |

---

## 6. 状态管理

### 6.1 Store 结构

```
stores/
├── auth.ts           # 认证状态
│   ├── user          # 当前用户信息
│   ├── token         # 访问令牌
│   ├── permissions   # 权限列表
│   ├── login()       # 登录
│   ├── logout()      # 登出
│   └── refreshToken()# 刷新令牌
│
├── session.ts        # 会话状态
│   ├── sessions      # 会话列表
│   ├── currentId     # 当前会话 ID
│   ├── fetchSessions()
│   ├── createSession()
│   ├── deleteSession()
│   └── switchSession()
│
├── chat.ts           # 对话状态
│   ├── messages      # 当前会话消息
│   ├── isLoading     # 加载状态
│   ├── isStreaming   # 流式输出中
│   ├── config        # 对话配置
│   ├── sendMessage()
│   ├── stopGeneration()
│   └── clearMessages()
│
├── models.ts         # 模型状态
│   ├── models        # 模型列表
│   ├── defaultModel  # 默认模型
│   ├── fetchModels()
│   └── getAvailableModels()
│
├── mcp.ts            # MCP 状态
│   ├── connections   # 连接列表
│   ├── tools         # 工具列表（按连接分组）
│   ├── fetchConnections()
│   └── getAvailableTools()
│
├── knowledge.ts      # 知识库状态
│   ├── knowledgeBases
│   ├── fetchKnowledgeBases()
│   └── getAvailableBases()
│
├── skills.ts         # SKILL 状态
│   ├── skills
│   ├── fetchSkills()
│   └── getAvailableSkills()
│
└── settings.ts       # 设置状态
    ├── theme         # 主题设置
    └── language      # 语言设置
```

### 6.2 AG-UI 客户端管理

本系统采用 AG-UI（Agent-User Interaction Protocol）协议与后端 Agent 通信，基于 HTTP SSE 实现流式响应。

```
composables/
└── useAgentChat.ts
    ├── isStreaming      # 是否正在接收流
    ├── currentRunId     # 当前运行 ID
    ├── abortController  # 用于取消请求
    │
    ├── runAgent(input: RunAgentInput) → void
    │   ├── 发送 POST 请求到 /api/v1/agent/run
    │   ├── 接收 SSE 事件流
    │   └── 解析 AG-UI 事件并更新状态
    │
    ├── stopRun() → void
    │   └── 取消当前运行
    │
    ├── onRunStarted(callback) → void
    │   └── RUN_STARTED 事件回调
    │
    ├── onRunFinished(callback) → void
    │   └── RUN_FINISHED 事件回调
    │
    ├── onRunError(callback) → void
    │   └── RUN_ERROR 事件回调
    │
    ├── onTextMessage(callback) → void
    │   └── TEXT_MESSAGE_* 事件回调
    │
    ├── onToolCall(callback) → void
    │   └── TOOL_CALL_* 事件回调
    │
    ├── onStep(callback) → void
    │   └── STEP_* 事件回调（思考过程）
    │
    └── parseSSEEvent(event) → AGUIEvent
        └── 解析 SSE 事件为 AG-UI 事件对象
```

#### AG-UI 事件处理流程

```
1. 用户发送消息
   ↓
2. 构建 RunAgentInput 请求
   ↓
3. POST /api/v1/agent/run （Accept: text/event-stream）
   ↓
4. 接收 SSE 事件流
   ↓
5. 根据事件类型更新 UI：
   - RUN_STARTED → 显示加载状态
   - STEP_STARTED → 显示思考过程
   - TEXT_MESSAGE_CONTENT → 实时显示文本
   - TOOL_CALL_* → 显示工具调用
   - RUN_FINISHED → 结束加载状态
   - RUN_ERROR → 显示错误信息
```

#### AG-UI 事件类型映射

| AG-UI 事件 | UI 更新 |
|-----------|---------|
| RUN_STARTED | 开始加载动画 |
| STEP_STARTED(thinking) | 展开思考过程区域 |
| TEXT_MESSAGE_START | 创建新消息气泡 |
| TEXT_MESSAGE_CONTENT | 追加文本到消息 |
| TEXT_MESSAGE_END | 消息渲染完成 |
| TOOL_CALL_START | 显示工具调用卡片 |
| TOOL_CALL_RESULT | 显示工具执行结果 |
| STEP_FINISHED | 收起思考过程区域 |
| RUN_FINISHED | 结束加载动画 |
| RUN_ERROR | 显示错误提示 |

---

## 7. 响应式设计

### 7.1 断点定义

| 断点 | 宽度 | 说明 |
|------|------|------|
| xs | < 768px | 不支持（需要桌面浏览器） |
| sm | 768px - 1024px | 小屏幕 |
| md | 1024px - 1280px | 中等屏幕 |
| lg | 1280px - 1920px | 大屏幕 |
| xl | > 1920px | 超大屏幕 |

### 7.2 响应式策略

| 屏幕 | 侧边栏 | 内容区 |
|------|--------|--------|
| sm | 可折叠，默认收起 | 全宽 |
| md+ | 固定展开 | 自适应 |

---

## 8. 附录

### 8.1 相关文档

- [产品需求文档](./ProductRequirements.md)
- [系统架构设计](./SystemArchitecture.md)
- [后端模块设计](./BackendDesign.md)
- [数据库设计](./DatabaseDesign.md)
- [API 接口设计](./APIDesign.md)
- [开发计划](./DevelopmentPlan.md)
